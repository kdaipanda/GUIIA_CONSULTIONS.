import React, { useState, useEffect, createContext, useContext } from 'react';
import './App.css';
import './Custom.css';

// Importar formularios de especies
import {
  PerrosForm,
  GatosForm,
  TortugasForm,
  ErizosForm,
  HuronesForm,
  IguanasForm,
  HamstersForm,
  PatosPollosForm,
  AvesForm,
  ConejosForm
} from './components/forms';

// Context for veterinarian authentication
const VetContext = createContext();

const useVet = () => {
  const context = useContext(VetContext);
  if (!context) {
    throw new Error('useVet must be used within a VetProvider');
  }
  return context;
};

const VetProvider = ({ children }) => {
  const [veterinarian, setVeterinarian] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // Check for stored veterinarian data
    const storedVet = localStorage.getItem('veterinarian');
    if (storedVet) {
      setVeterinarian(JSON.parse(storedVet));
    }
    setLoading(false);
  }, []);

  const login = (vetData) => {
    setVeterinarian(vetData);
    localStorage.setItem('veterinarian', JSON.stringify(vetData));
  };

  const logout = () => {
    setVeterinarian(null);
    localStorage.removeItem('veterinarian');
  };

  return (
    <VetContext.Provider value={{ veterinarian, login, logout, loading }}>
      {children}
    </VetContext.Provider>
  );
};

// Main App Component
function App() {
  return (
    <VetProvider>
      <div className="App">
        <Router />
      </div>
    </VetProvider>
  );
}

// Router Component
const Router = () => {
  const [currentView, setCurrentView] = useState('landing');
  const { veterinarian, loading } = useVet();

  // URL parameter handling for payment success
  useEffect(() => {
    const urlParams = new URLSearchParams(window.location.search);
    const sessionId = urlParams.get('session_id');
    const view = urlParams.get('view');
    
    if (sessionId) {
      setCurrentView('payment-success');
    } else if (view) {
      setCurrentView(view);
    } else if (veterinarian) {
      setCurrentView('dashboard');
    }
  }, [veterinarian]);

  if (loading) {
    return <LoadingScreen />;
  }

  const views = {
    'landing': <LandingPage setView={setCurrentView} />,
    'register': <RegisterPage setView={setCurrentView} />,
    'login': <LoginPage setView={setCurrentView} />,
    'dashboard': <Dashboard setView={setCurrentView} />,
    'new-consultation': <NewConsultation setView={setCurrentView} />,
    'consultation-history': <ConsultationHistory setView={setCurrentView} />,
    'medical-images': <MedicalImageInterpretation setView={setCurrentView} />,
    'membership': <MembershipPage setView={setCurrentView} />,
    'payment-success': <PaymentSuccess setView={setCurrentView} />,
    'profile': <Profile setView={setCurrentView} />
  };

  return views[currentView] || <LandingPage setView={setCurrentView} />;
};

// Loading Screen
const LoadingScreen = () => (
  <div className="loading-screen">
    <div className="loading-spinner"></div>
    <p>Cargando Savant Vet...</p>
  </div>
);

// Navigation Header
const Header = ({ setView, showAuth = true }) => {
  const { veterinarian, logout } = useVet();
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [isUserMenuOpen, setIsUserMenuOpen] = useState(false);
  const [isAtTop, setIsAtTop] = useState(true);
  const [currentTime, setCurrentTime] = useState(new Date());

  useEffect(() => {
    const handleScroll = () => {
      const currentScrollY = window.scrollY;
      
      // Update if at top for transparency effect
      setIsAtTop(currentScrollY < 50);
    };

    window.addEventListener('scroll', handleScroll, { passive: true });
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  useEffect(() => {
    const handleClickOutside = (event) => {
      if (isUserMenuOpen && !event.target.closest('.user-menu-container')) {
        setIsUserMenuOpen(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, [isUserMenuOpen]);

  useEffect(() => {
    // Update time every second
    const timer = setInterval(() => {
      setCurrentTime(new Date());
    }, 1000);

    return () => clearInterval(timer);
  }, []);

  const toggleMenu = () => {
    setIsMenuOpen(!isMenuOpen);
  };

  const toggleUserMenu = () => {
    setIsUserMenuOpen(!isUserMenuOpen);
  };

  const formatTime = (date) => {
    return date.toLocaleTimeString('es-MX', { 
      hour: '2-digit', 
      minute: '2-digit',
      second: '2-digit',
      hour12: true 
    });
  };

  const formatDate = (date) => {
    return date.toLocaleDateString('es-MX', { 
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  };

  return (
    <header className={`header ${isAtTop ? '' : 'transparent'}`}>
      <div className="container">
        <div className="nav-brand" onClick={() => setView(veterinarian ? 'dashboard' : 'landing')}>
          <img src="/savant_logo.png" alt="Savant Vet" className="logo-image" />
          <h1>Savant Vet</h1>
        </div>
        
        {showAuth && (
          <>
            <button className="menu-toggle" onClick={toggleMenu}>
              {isMenuOpen ? '‚úï' : '‚ò∞'}
            </button>
            <nav className={`nav-menu ${isMenuOpen ? 'mobile-open' : ''}`}>
              {veterinarian ? (
                <>
                  <button onClick={() => { setView('dashboard'); setIsMenuOpen(false); }} className="nav-link">
                    <span className="nav-icon">üè†</span>
                    Dashboard
                  </button>
                  <button onClick={() => { setView('new-consultation'); setIsMenuOpen(false); }} className="nav-link">
                    <span className="nav-icon">‚ûï</span>
                    Nueva Consulta
                  </button>
                  <button onClick={() => { setView('consultation-history'); setIsMenuOpen(false); }} className="nav-link">
                    <span className="nav-icon">üìã</span>
                    Historial
                  </button>
                  <button onClick={() => { setView('membership'); setIsMenuOpen(false); }} className="nav-link">
                    <span className="nav-icon">‚≠ê</span>
                    Membres√≠a
                  </button>
                  
                  <div className="header-clock">
                    <div className="clock-icon">üïê</div>
                    <div className="clock-info">
                      <div className="clock-time">{formatTime(currentTime)}</div>
                      <div className="clock-date">{formatDate(currentTime)}</div>
                    </div>
                  </div>
                  
                  <div className="user-menu-container">
                    <button className="user-menu-trigger" onClick={toggleUserMenu}>
                      <div className="user-avatar">
                        {veterinarian.nombre.charAt(0).toUpperCase()}
                      </div>
                      <div className="user-info-compact">
                        <span className="user-name-compact">{veterinarian.nombre}</span>
                        <span className="user-membership-compact">{veterinarian.membership_type || 'B√°sica'}</span>
                      </div>
                      <span className="dropdown-arrow">{isUserMenuOpen ? '‚ñ≤' : '‚ñº'}</span>
                    </button>
                    
                    {isUserMenuOpen && (
                      <div className="user-dropdown-menu">
                        <div className="user-dropdown-header">
                          <div className="user-avatar-large">
                            {veterinarian.nombre.charAt(0).toUpperCase()}
                          </div>
                          <div className="user-dropdown-info">
                            <span className="user-dropdown-name">{veterinarian.nombre}</span>
                            <span className="user-dropdown-email">{veterinarian.email}</span>
                            <span className="user-dropdown-membership">
                              Plan: {veterinarian.membership_type || 'B√°sica'}
                            </span>
                          </div>
                        </div>
                        <div className="user-dropdown-divider"></div>
                        <button onClick={() => { setView('profile'); setIsUserMenuOpen(false); setIsMenuOpen(false); }} className="user-dropdown-item">
                          <span className="dropdown-icon">üë§</span>
                          Mi Perfil
                        </button>
                        <button onClick={() => { setView('membership'); setIsUserMenuOpen(false); setIsMenuOpen(false); }} className="user-dropdown-item">
                          <span className="dropdown-icon">‚≠ê</span>
                          Mi Membres√≠a
                        </button>
                        <button onClick={() => { setView('consultation-history'); setIsUserMenuOpen(false); setIsMenuOpen(false); }} className="user-dropdown-item">
                          <span className="dropdown-icon">üìä</span>
                          Estad√≠sticas
                        </button>
                        <div className="user-dropdown-divider"></div>
                        <button onClick={() => { logout(); setIsUserMenuOpen(false); setIsMenuOpen(false); }} className="user-dropdown-item logout-item">
                          <span className="dropdown-icon">üö™</span>
                          Cerrar Sesi√≥n
                        </button>
                      </div>
                    )}
                  </div>
                </>
              ) : (
                <>
                  <button onClick={() => { setView('login'); setIsMenuOpen(false); }} className="nav-link">
                    Iniciar Sesi√≥n
                  </button>
                  <button onClick={() => { setView('register'); setIsMenuOpen(false); }} className="btn btn-primary">
                    Registrarse
                  </button>
                </>
              )}
            </nav>
          </>
        )}
      </div>
    </header>
  );
};

// Landing Page
const LandingPage = ({ setView }) => {
  return (
    <div className="landing-page">
      <Header setView={setView} />
      
      <section className="hero">
        <div className="container">
          <div className="hero-main">
            <h1>Plataforma M√©dica Profesional para Veterinarios Certificados</h1>
            <p>Savant Vet es una plataforma especializada de consultor√≠a veterinaria dise√±ada exclusivamente para m√©dicos veterinarios profesionales. Obt√©n diagn√≥sticos especializados, an√°lisis cl√≠nicos avanzados y planes de tratamiento basados en evidencia cient√≠fica para brindar el mejor cuidado a tus pacientes.</p>
            
            <div className="hero-actions">
              <button onClick={() => setView('register')} className="btn btn-primary btn-large">
                Registrarse como Veterinario
                <span className="btn-arrow">‚Üí</span>
              </button>
            </div>
          </div>

          <div className="hero-images">
            <div className="hero-image-card purple">
              <img src="https://images.unsplash.com/photo-1596272875729-ed2ff7d6d9c5?w=400&h=400&fit=crop&crop=faces&auto=format&q=85" alt="Veterinario profesional con gato" />
            </div>
            <div className="hero-image-card blue">
              <img src="https://images.unsplash.com/photo-1654895716780-b4664497420d?w=600&h=400&fit=crop&crop=faces&auto=format&q=85" alt="Consulta veterinaria profesional" />
            </div>
            <div className="hero-image-card yellow">
              <img src="https://images.unsplash.com/photo-1628009368231-7bb7cfcb0def?w=400&h=400&fit=crop&crop=faces&auto=format&q=85" alt="Veterinaria amigable con mascota" />
            </div>
          </div>
        </div>
      </section>

      <section className="services-badges">
        <div className="container">
          <div className="badges-grid">
            <div className="service-badge">
              <span className="badge-dot purple"></span>
              Solo veterinarios certificados
            </div>
            <div className="service-badge">
              <span className="badge-dot blue"></span>
              An√°lisis cl√≠nico especializado
            </div>
            <div className="service-badge">
              <span className="badge-dot green"></span>
              Diagn√≥sticos diferenciales
            </div>
            <div className="service-badge">
              <span className="badge-dot orange"></span>
              Planes de tratamiento
            </div>
            <div className="service-badge">
              <span className="badge-dot teal"></span>
              Consultor√≠a por especies
            </div>
            <div className="service-badge">
              <span className="badge-dot yellow"></span>
              Evidencia cient√≠fica
            </div>
          </div>
        </div>
      </section>

      <section className="services">
        <div className="container">
          <div className="services-badge">
            <span className="badge-dot orange"></span>
            Servicios que ofrecemos
          </div>
          
          <h2>Servicios veterinarios adaptados a las necesidades de tus pacientes</h2>
          
          <div className="services-grid">
            <div className="service-card">
              <div className="service-icon yellow">
                <span>üî¨</span>
              </div>
              <h3>An√°lisis Diagn√≥stico Especializado</h3>
              <p>An√°lisis veterinario profesional con inteligencia especializada para obtener diagn√≥sticos diferenciales precisos y planes de tratamiento basados en evidencia cient√≠fica.</p>
            </div>
            
            <div className="service-card">
              <div className="service-icon blue">
                <span>üêï</span>
              </div>
              <h3>Consultas Categorizadas por Especies</h3>
              <p>Sistemas especializados para peque√±as especies, animales de producci√≥n, equinos y ex√≥ticos. Cada categor√≠a con protocolos espec√≠ficos y actualizados.</p>
            </div>
            
            <div className="service-card">
              <div className="service-icon orange">
                <span>‚öïÔ∏è</span>
              </div>
              <h3>Plataforma Profesional Verificada</h3>
              <p>Acceso exclusivo para m√©dicos veterinarios certificados con validaci√≥n de c√©dulas profesionales mexicanas para garantizar la calidad del servicio.</p>
            </div>
          </div>
        </div>
      </section>

      <section id="membresias" className="memberships">
        <div className="container">
          <div className="memberships-header">
            <div className="services-badge">
              <span className="badge-dot purple"></span>
              Membres√≠as
            </div>
            <h2>Planes dise√±ados para profesionales veterinarios</h2>
            <p>Elige el plan que mejor se adapte a tu pr√°ctica profesional y volumen de consultas</p>
          </div>
          
          <div className="membership-cards">
            <div className="membership-card basic">
              <div className="membership-header">
                <h3>B√°sica</h3>
                <div className="price">
                  <span className="currency">$</span>
                  <span className="amount">299</span>
                  <span className="period">MXN/mes</span>
                </div>
              </div>
              <div className="membership-features">
                <div className="feature">‚úÖ 10 consultas mensuales</div>
                <div className="feature">‚úÖ An√°lisis especializado por categor√≠a</div>
                <div className="feature">‚úÖ Diagn√≥sticos diferenciales</div>
                <div className="feature">‚úÖ Planes de tratamiento</div>
                <div className="feature">‚úÖ Soporte por email</div>
              </div>
            </div>

            <div className="membership-card professional">
              <div className="membership-header">
                <h3>Profesional</h3>
                <div className="price">
                  <span className="currency">$</span>
                  <span className="amount">599</span>
                  <span className="period">MXN/mes</span>
                </div>
              </div>
              <div className="membership-features">
                <div className="feature">‚úÖ 25 consultas mensuales</div>
                <div className="feature">‚úÖ Todas las funciones de B√°sica</div>
                <div className="feature">‚úÖ Soporte prioritario</div>
                <div className="feature">‚úÖ Historial extendido</div>
                <div className="feature">‚úÖ Referencias bibliogr√°ficas</div>
              </div>
            </div>

            <div className="membership-card premium featured">
              <div className="popular-badge">M√°s Popular</div>
              <div className="membership-header">
                <h3>Premium</h3>
                <div className="price">
                  <span className="currency">$</span>
                  <span className="amount">999</span>
                  <span className="period">MXN/mes</span>
                </div>
              </div>
              <div className="membership-features">
                <div className="feature">‚úÖ Consultas ilimitadas</div>
                <div className="feature">‚úÖ Todas las funciones de Profesional</div>
                <div className="feature">‚úÖ Soporte 24/7</div>
                <div className="feature">‚úÖ Contenido exclusivo</div>
                <div className="feature">‚úÖ An√°lisis avanzados</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section className="cta">
        <div className="container">
          <div className="cta-content">
            <h2>¬øListo para revolucionar tus consultas veterinarias?</h2>
            <p>√önete a cientos de veterinarios que ya conf√≠an en Savant Vet</p>
            <button onClick={() => setView('login')} className="btn btn-primary btn-large">
              Iniciar Sesi√≥n
            </button>
          </div>
        </div>
      </section>

      <footer className="footer">
        <div className="container">
          <div className="footer-content">
            <div className="footer-section">
              <div className="footer-brand">
                <h3>Savant Vet</h3>
                <p>Plataforma profesional de consultor√≠a veterinaria especializada para m√©dicos veterinarios certificados en M√©xico.</p>
                <div className="footer-contact">
                  <p><strong>Email:</strong> contacto@savantvet.com</p>
                  <p><strong>Tel√©fono:</strong> +52 55 1234 5678</p>
                  <p><strong>Horario:</strong> Lun - Vie 9:00 - 18:00</p>
                </div>
              </div>
            </div>

            <div className="footer-section">
              <h4>Servicios</h4>
              <ul>
                <li><a href="#" onClick={() => setView('register')}>An√°lisis Diagn√≥stico</a></li>
                <li><a href="#" onClick={() => setView('register')}>Consultas Especializadas</a></li>
                <li><a href="#" onClick={() => setView('register')}>Peque√±as Especies</a></li>
                <li><a href="#" onClick={() => setView('register')}>Animales de Producci√≥n</a></li>
                <li><a href="#" onClick={() => setView('register')}>Equinos</a></li>
                <li><a href="#" onClick={() => setView('register')}>Animales Ex√≥ticos</a></li>
              </ul>
            </div>

            <div className="footer-section">
              <h4>Empresa</h4>
              <ul>
                <li><a href="#" onClick={() => setView('landing')}>Acerca de Nosotros</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Nuestro Equipo</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Misi√≥n y Visi√≥n</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Contacto</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Carreras</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Blog</a></li>
              </ul>
            </div>

            <div className="footer-section">
              <h4>Membres√≠as</h4>
              <ul>
                <li><a href="#" onClick={() => setView('membership')}>Plan B√°sico</a></li>
                <li><a href="#" onClick={() => setView('membership')}>Plan Profesional</a></li>
                <li><a href="#" onClick={() => setView('membership')}>Plan Premium</a></li>
                <li><a href="#" onClick={() => setView('membership')}>Comparar Planes</a></li>
                <li><a href="#" onClick={() => setView('membership')}>Preguntas Frecuentes</a></li>
                <li><a href="#" onClick={() => setView('membership')}>Soporte</a></li>
              </ul>
            </div>

            <div className="footer-section">
              <h4>Legal</h4>
              <ul>
                <li><a href="#" onClick={() => setView('landing')}>T√©rminos de Servicio</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Pol√≠tica de Privacidad</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Pol√≠tica de Cookies</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Cumplimiento LOPD</a></li>
                <li><a href="#" onClick={() => setView('landing')}>C√≥digo de √âtica</a></li>
                <li><a href="#" onClick={() => setView('landing')}>Licencias</a></li>
              </ul>
            </div>
          </div>

          <div className="footer-bottom">
            <div className="footer-bottom-content">
              <p>&copy; 2025 Savant Vet. Todos los derechos reservados.</p>
              <div className="footer-social">
                <span>S√≠guenos:</span>
                <a href="#" className="social-link">LinkedIn</a>
                <a href="#" className="social-link">Twitter</a>
                <a href="#" className="social-link">Instagram</a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>
  );
};

// Register Page
const RegisterPage = ({ setView }) => {
  const { login } = useVet();
  const [formData, setFormData] = useState({
    nombre: '',
    email: '',
    telefono: '',
    cedula_profesional: '',
    especialidad: '',
    a√±os_experiencia: '',
    institucion: ''
  });
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/auth/register`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          ...formData,
          a√±os_experiencia: parseInt(formData.a√±os_experiencia)
        })
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.detail || 'Error en el registro');
      }

      const vetData = await response.json();
      login(vetData);
      setView('dashboard');
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="auth-page">
      <Header setView={setView} showAuth={false} />
      
      <div className="auth-container">
        <div className="auth-card">
          <h2>Registro Profesional</h2>
          <p>Complete sus datos profesionales para acceder a la plataforma</p>

          {error && <div className="error-message">{error}</div>}

          <form onSubmit={handleSubmit} className="auth-form">
            <div className="form-row">
              <div className="form-group">
                <label>Nombre Completo *</label>
                <input
                  type="text"
                  required
                  value={formData.nombre}
                  onChange={(e) => setFormData({...formData, nombre: e.target.value})}
                  placeholder="Dr. Juan P√©rez"
                />
              </div>
              <div className="form-group">
                <label>Email *</label>
                <input
                  type="email"
                  required
                  value={formData.email}
                  onChange={(e) => setFormData({...formData, email: e.target.value})}
                  placeholder="juan.perez@email.com"
                />
              </div>
            </div>

            <div className="form-row">
              <div className="form-group">
                <label>Tel√©fono *</label>
                <input
                  type="tel"
                  required
                  value={formData.telefono}
                  onChange={(e) => setFormData({...formData, telefono: e.target.value})}
                  placeholder="+52 555 123 4567"
                />
              </div>
              <div className="form-group">
                <label>C√©dula Profesional *</label>
                <input
                  type="text"
                  required
                  value={formData.cedula_profesional}
                  onChange={(e) => setFormData({...formData, cedula_profesional: e.target.value})}
                  placeholder="12345678"
                />
              </div>
            </div>

            <div className="form-group">
              <label>Especialidad *</label>
              <select
                required
                value={formData.especialidad}
                onChange={(e) => setFormData({...formData, especialidad: e.target.value})}
              >
                <option value="">Seleccione una especialidad</option>
                <option value="Peque√±as Especies">Peque√±as Especies</option>
                <option value="Animales de Producci√≥n">Animales de Producci√≥n</option>
                <option value="Equinos">Equinos</option>
                <option value="Animales Ex√≥ticos">Animales Ex√≥ticos</option>
                <option value="Medicina Preventiva">Medicina Preventiva</option>
                <option value="Patolog√≠a">Patolog√≠a</option>
                <option value="Cirug√≠a">Cirug√≠a</option>
                <option value="Medicina Interna">Medicina Interna</option>
              </select>
            </div>

            <div className="form-row">
              <div className="form-group">
                <label>A√±os de Experiencia *</label>
                <input
                  type="number"
                  required
                  min="0"
                  max="50"
                  value={formData.a√±os_experiencia}
                  onChange={(e) => setFormData({...formData, a√±os_experiencia: e.target.value})}
                  placeholder="5"
                />
              </div>
              <div className="form-group">
                <label>Instituci√≥n *</label>
                <input
                  type="text"
                  required
                  value={formData.institucion}
                  onChange={(e) => setFormData({...formData, institucion: e.target.value})}
                  placeholder="Hospital Veterinario ABC"
                />
              </div>
            </div>

            <button type="submit" disabled={loading} className="btn btn-primary btn-full">
              {loading ? 'Registrando...' : 'Registrarse'}
            </button>
          </form>

          <div className="auth-footer">
            ¬øYa tienes una cuenta?{' '}
            <button onClick={() => setView('login')} className="link-btn">
              Inicia Sesi√≥n
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

// Login Page
const LoginPage = ({ setView }) => {
  const { login } = useVet();
  const [formData, setFormData] = useState({
    email: '',
    cedula_profesional: ''
  });
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/auth/login`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.detail || 'Error en el login');
      }

      const vetData = await response.json();
      login(vetData);
      setView('dashboard');
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="auth-page">
      <Header setView={setView} showAuth={false} />
      
      <div className="auth-container">
        <div className="auth-card">
          <h2>Iniciar Sesi√≥n</h2>
          <p>Ingresa con tu email y c√©dula profesional</p>

          {error && <div className="error-message">{error}</div>}

          <form onSubmit={handleSubmit} className="auth-form">
            <div className="form-group">
              <label>Email</label>
              <input
                type="email"
                required
                value={formData.email}
                onChange={(e) => setFormData({...formData, email: e.target.value})}
                placeholder="tu.email@ejemplo.com"
              />
            </div>

            <div className="form-group">
              <label>C√©dula Profesional</label>
              <input
                type="text"
                required
                value={formData.cedula_profesional}
                onChange={(e) => setFormData({...formData, cedula_profesional: e.target.value})}
                placeholder="12345678"
              />
            </div>

            <button type="submit" disabled={loading} className="btn btn-primary btn-full">
              {loading ? 'Iniciando Sesi√≥n...' : 'Iniciar Sesi√≥n'}
            </button>
          </form>

          <div className="auth-footer">
            ¬øNo tienes una cuenta?{' '}
            <button onClick={() => setView('register')} className="link-btn">
              Reg√≠strate
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

// Dashboard
const Dashboard = ({ setView }) => {
  const { veterinarian } = useVet();
  const [stats, setStats] = useState({ consultations: 0, thisMonth: 0 });
  const [recentConsultations, setRecentConsultations] = useState([]);

  useEffect(() => {
    if (veterinarian) {
      loadDashboardData();
    }
  }, [veterinarian]);

  const loadDashboardData = async () => {
    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/consultations/${veterinarian.id}/history`);
      if (response.ok) {
        const data = await response.json();
        const consultations = data.consultations || [];
        
        const thisMonth = consultations.filter(c => {
          const date = new Date(c.created_at);
          const now = new Date();
          return date.getMonth() === now.getMonth() && date.getFullYear() === now.getFullYear();
        }).length;

        setStats({
          consultations: consultations.length,
          thisMonth
        });
        
        setRecentConsultations(consultations.slice(0, 5));
      }
    } catch (error) {
      console.error('Error loading dashboard data:', error);
    }
  };

  const getMembershipStatus = () => {
    if (!veterinarian.membership_type) {
      return { status: 'Sin membres√≠a', color: 'red', consultations: 'N/A' };
    }

    const remaining = veterinarian.consultations_remaining;
    if (veterinarian.membership_type === 'premium') {
      return { status: 'Premium', color: 'gold', consultations: 'Ilimitadas' };
    }

    return {
      status: veterinarian.membership_type === 'basic' ? 'B√°sica' : 'Profesional',
      color: remaining > 5 ? 'green' : remaining > 0 ? 'orange' : 'red',
      consultations: remaining
    };
  };

  const membershipStatus = getMembershipStatus();

  return (
    <div className="dashboard-page">
      <Header setView={setView} />
      
      <div className="container">
        <div className="dashboard-header">
          <h1>Bienvenido, {veterinarian.nombre}</h1>
          <p>Gestiona tus consultas veterinarias y membres√≠a</p>
        </div>

        <div className="dashboard-grid">
          <div className="stats-cards">
            <div className="stat-card">
              <div className="stat-icon">üìä</div>
              <div className="stat-content">
                <h3>{stats.consultations}</h3>
                <p>Consultas Totales</p>
              </div>
            </div>
            
            <div className="stat-card">
              <div className="stat-icon">üìÖ</div>
              <div className="stat-content">
                <h3>{stats.thisMonth}</h3>
                <p>Este Mes</p>
              </div>
            </div>
            
            <div className="stat-card">
              <div className="stat-icon" style={{color: membershipStatus.color}}>üíé</div>
              <div className="stat-content">
                <h3>{membershipStatus.status}</h3>
                <p>{membershipStatus.consultations} consultas</p>
              </div>
            </div>
          </div>

          <div className="quick-actions">
            <h2>Acciones R√°pidas</h2>
            <div className="action-cards">
              <button onClick={() => setView('new-consultation')} className="action-card">
                <div className="action-icon">‚ûï</div>
                <h3>Nueva Consulta</h3>
                <p>Iniciar an√°lisis especializado</p>
              </button>
              
              <button onClick={() => setView('consultation-history')} className="action-card">
                <div className="action-icon">üìã</div>
                <h3>Ver Historial</h3>
                <p>Consultas previas y resultados</p>
              </button>
              
              {veterinarian.membership_type?.toLowerCase() === 'premium' && (
                <button onClick={() => setView('medical-images')} className="action-card premium-feature">
                  <div className="action-icon">üî¨</div>
                  <h3>Interpretar Im√°genes</h3>
                  <p>Rayos X y an√°lisis de laboratorio</p>
                  <span className="premium-badge">PREMIUM</span>
                </button>
              )}
              
              <button onClick={() => setView('membership')} className="action-card">
                <div className="action-icon">‚≠ê</div>
                <h3>Membres√≠a</h3>
                <p>Actualizar plan o renovar</p>
              </button>
            </div>
          </div>

          <div className="recent-consultations">
            <h2>Consultas Recientes</h2>
            {recentConsultations.length > 0 ? (
              <div className="consultation-list">
                {recentConsultations.map((consultation) => (
                  <div key={consultation.id} className="consultation-item">
                    <div className="consultation-info">
                      <h4>{consultation.especie} - {consultation.raza}</h4>
                      <p>{consultation.motivo_consulta}</p>
                      <small>{new Date(consultation.created_at).toLocaleDateString()}</small>
                    </div>
                    <span className={`status ${consultation.status}`}>
                      {consultation.status === 'completed' ? 'Completada' : 
                       consultation.status === 'in_progress' ? 'En Progreso' : 'Borrador'}
                    </span>
                  </div>
                ))}
              </div>
            ) : (
              <div className="empty-state">
                <p>No hay consultas recientes</p>
                <button onClick={() => setView('new-consultation')} className="btn btn-primary">
                  Crear Primera Consulta
                </button>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
};

// New Consultation Component
const NewConsultation = ({ setView }) => {
  const { veterinarian } = useVet();
  const [step, setStep] = useState(1);
  const [categories, setCategories] = useState({});
  const [selectedCategory, setSelectedCategory] = useState('');
  const [consultationId, setConsultationId] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  // Form data for all steps
  const [formData, setFormData] = useState({
    // Step 1: Complete pet information
    fecha: new Date().toISOString().split('T')[0],
    nombre_mascota: '',
    nombre_due√±o: '',
    raza: '',
    mix: '',
    edad: '',
    peso: '',
    condicion_corporal: '3',
    sexo: '',
    estado_reproductivo: '',
    vacunas_vigentes: '',
    vacunas_cual: '',
    desparasitacion_interna: '',
    desparasitacion_interna_cual: '',
    desparasitacion_externa: '',
    desparasitacion_externa_producto: '',
    desparasitacion_externa_fecha: '',
    habitat: '',
    zona_geografica: '',
    alimentacion_seco: '',
    alimentacion_humedo: '',
    alimentacion_casero: '',
    alimentacion_frecuencia: '',
    paseos: '',
    paseos_frecuencia: '',
    ba√±os_estetica: '',
    ba√±os_fecha: '',
    cirugias_previas: '',
    cirugias_cual: '',
    aspecto_pelaje: '',
    aspecto_piel: '',
    aspecto_oidos: '',
    aspecto_ojos: '',
    aspecto_otros: '',
    
    // Historial reportado
    vomito: 'NO',
    vomito_color: '',
    vomito_aspecto: '',
    diarrea: 'NO',
    diarrea_color: '',
    diarrea_aspecto: '',
    orina: 'NO',
    orina_color: '',
    orina_olor: '',
    secrecion_nasal: 'NO',
    secrecion_nasal_color: '',
    secrecion_nasal_aspecto: '',
    secrecion_ocular: 'NO',
    secrecion_ocular_color: '',
    dientes: 'limpios',
    dientes_otros: '',
    piel_condicion: 'normal',
    ultima_comida: '',
    ultima_comida_fecha: '',
    liquidos: '',
    liquidos_cantidad: '',
    actividad_general: 'ACTIVO',
    medicamentos: 'NO',
    medicamentos_cual: '',
    
    // Stage 2: Detailed patient information
    detalle_paciente: ''
  });

  const [aiAnalysis, setAiAnalysis] = useState(null);

  useEffect(() => {
    loadCategories();
  }, []);

  const loadCategories = async () => {
    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/animal-categories`);
      if (response.ok) {
        const data = await response.json();
        setCategories(data.categories);
      }
    } catch (error) {
      console.error('Error loading categories:', error);
    }
  };

  // Funci√≥n para renderizar el formulario correcto seg√∫n la categor√≠a
  const renderSpeciesForm = () => {
    if (!selectedCategory) {
      return (
        <div className="form-section">
          <p className="info-message">Por favor, selecciona una categor√≠a de animal para continuar.</p>
        </div>
      );
    }

    const formProps = {
      formData,
      setFormData
    };

    switch(selectedCategory) {
      case 'perros':
        return <PerrosForm {...formProps} />;
      case 'gatos':
        return <GatosForm {...formProps} />;
      case 'tortugas':
        return <TortugasForm {...formProps} />;
      case 'erizos':
        return <ErizosForm {...formProps} />;
      case 'hurones':
        return <HuronesForm {...formProps} />;
      case 'iguanas':
        return <IguanasForm {...formProps} />;
      case 'hamsters':
        return <HamstersForm {...formProps} />;
      case 'aves_corral':
        return <PatosPollosForm {...formProps} />;
      case 'aves_ornamentales':
        return <AvesForm {...formProps} />;
      case 'conejos':
        return <ConejosForm {...formProps} />;
      default:
        return (
          <div className="form-section">
            <p className="error-message">Categor√≠a no reconocida. Por favor, selecciona una categor√≠a v√°lida.</p>
          </div>
        );
    }
  };

  const handleSubmitStep1 = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/consultations`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          veterinarian_id: veterinarian.id,
          category: selectedCategory,
          consultation_data: {
            fecha: formData.fecha,
            nombre_mascota: formData.nombre_mascota,
            nombre_due√±o: formData.nombre_due√±o,
            raza: formData.raza,
            mix: formData.mix,
            edad: formData.edad,
            peso: formData.peso,
            condicion_corporal: formData.condicion_corporal,
            sexo: formData.sexo,
            estado_reproductivo: formData.estado_reproductivo,
            vacunas_vigentes: formData.vacunas_vigentes,
            vacunas_cual: formData.vacunas_cual,
            desparasitacion_interna: formData.desparasitacion_interna,
            desparasitacion_interna_cual: formData.desparasitacion_interna_cual,
            desparasitacion_externa: formData.desparasitacion_externa,
            desparasitacion_externa_producto: formData.desparasitacion_externa_producto,
            desparasitacion_externa_fecha: formData.desparasitacion_externa_fecha,
            habitat: formData.habitat,
            zona_geografica: formData.zona_geografica,
            alimentacion_seco: formData.alimentacion_seco,
            alimentacion_humedo: formData.alimentacion_humedo,
            alimentacion_casero: formData.alimentacion_casero,
            alimentacion_frecuencia: formData.alimentacion_frecuencia,
            paseos: formData.paseos,
            paseos_frecuencia: formData.paseos_frecuencia,
            ba√±os_estetica: formData.ba√±os_estetica,
            ba√±os_fecha: formData.ba√±os_fecha,
            cirugias_previas: formData.cirugias_previas,
            cirugias_cual: formData.cirugias_cual,
            aspecto_pelaje: formData.aspecto_pelaje,
            aspecto_piel: formData.aspecto_piel,
            aspecto_oidos: formData.aspecto_oidos,
            aspecto_ojos: formData.aspecto_ojos,
            aspecto_otros: formData.aspecto_otros,
            
            // Historial reportado
            vomito: formData.vomito,
            vomito_color: formData.vomito_color,
            vomito_aspecto: formData.vomito_aspecto,
            diarrea: formData.diarrea,
            diarrea_color: formData.diarrea_color,
            diarrea_aspecto: formData.diarrea_aspecto,
            orina: formData.orina,
            orina_color: formData.orina_color,
            orina_olor: formData.orina_olor,
            secrecion_nasal: formData.secrecion_nasal,
            secrecion_nasal_color: formData.secrecion_nasal_color,
            secrecion_nasal_aspecto: formData.secrecion_nasal_aspecto,
            secrecion_ocular: formData.secrecion_ocular,
            secrecion_ocular_color: formData.secrecion_ocular_color,
            dientes: formData.dientes,
            dientes_otros: formData.dientes_otros,
            piel_condicion: formData.piel_condicion,
            ultima_comida: formData.ultima_comida,
            ultima_comida_fecha: formData.ultima_comida_fecha,
            liquidos: formData.liquidos,
            liquidos_cantidad: formData.liquidos_cantidad,
            actividad_general: formData.actividad_general,
            medicamentos: formData.medicamentos,
            medicamentos_cual: formData.medicamentos_cual
          }
        })
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.detail || 'Error creando consulta');
      }

      const consultation = await response.json();
      setConsultationId(consultation.id);
      setStep(2);
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleSubmitStep2 = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/consultations/${consultationId}/observations`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          detalle_paciente: formData.detalle_paciente
        })
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.detail || 'Error actualizando observaciones');
      }

      setStep(3);
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleAIAnalysis = async () => {
    setLoading(true);
    setError('');

    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/consultations/${consultationId}/analyze`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.detail || 'Error en an√°lisis');
      }

      const result = await response.json();
      setAiAnalysis(result.analysis);
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  if (step === 1) {
    return (
      <div className="consultation-page">
        <Header setView={setView} />
        
        <div className="container">
          {error && <div className="error-message">{error}</div>}

          <div className="consultation-form-container">
            <div className="step-indicator">
              <div className="step active">1. Datos de la Mascota</div>
              <div className="step">2. Motivo de Consulta</div>
              <div className="step">3. An√°lisis Diagn√≥stico</div>
            </div>

            <form onSubmit={handleSubmitStep1} className="consultation-form">
              <div className="form-section">
                <h3>Categor√≠a Animal</h3>
                <div className="category-grid">
                  {Object.entries(categories).map(([key, category]) => (
                    <div
                      key={key}
                      className={`category-card ${selectedCategory === key ? 'selected' : ''}`}
                      onClick={() => setSelectedCategory(key)}
                    >
                      <h4>{category.name}</h4>
                    </div>
                  ))}
                </div>
              </div>

              {/* Renderizar el formulario espec√≠fico seg√∫n la categor√≠a seleccionada */}
              {renderSpeciesForm()}
                  <div className="form-group">
                    <label>Nombre de la Mascota *</label>
                    <input
                      type="text"
                      required
                      value={formData.nombre_mascota}
                      onChange={(e) => setFormData({...formData, nombre_mascota: e.target.value})}
                      placeholder="Nombre de la mascota"
                    />
                  </div>
                </div>

                <div className="form-row">
                  <div className="form-group">
                    <label>Nombre del Due√±o *</label>
                    <input
                      type="text"
                      required
                      value={formData.nombre_due√±o}
                      onChange={(e) => setFormData({...formData, nombre_due√±o: e.target.value})}
                      placeholder="Nombre completo del propietario"
                    />
                  </div>
                  <div className="form-group">
                    <label>Zona Geogr√°fica de Residencia *</label>
                    <input
                      type="text"
                      required
                      value={formData.zona_geografica}
                      onChange={(e) => setFormData({...formData, zona_geografica: e.target.value})}
                      placeholder="Ciudad, estado"
                    />
                  </div>
                </div>
              </div>

              <div className="form-section">
                <h3>Datos F√≠sicos de la Mascota</h3>
                <div className="form-row">
                  <div className="form-group">
                    <label>Raza *</label>
                    <input
                      type="text"
                      required
                      value={formData.raza}
                      onChange={(e) => setFormData({...formData, raza: e.target.value})}
                      placeholder="Labrador, Persa, Holstein..."
                    />
                  </div>
                  <div className="form-group">
                    <label>Mix</label>
                    <input
                      type="text"
                      value={formData.mix}
                      onChange={(e) => setFormData({...formData, mix: e.target.value})}
                      placeholder="Si es mestizo, especificar"
                    />
                  </div>
                </div>

                <div className="form-row">
                  <div className="form-group">
                    <label>Edad *</label>
                    <input
                      type="text"
                      required
                      value={formData.edad}
                      onChange={(e) => setFormData({...formData, edad: e.target.value})}
                      placeholder="2 a√±os, 6 meses..."
                    />
                  </div>
                  <div className="form-group">
                    <label>Peso *</label>
                    <input
                      type="text"
                      required
                      value={formData.peso}
                      onChange={(e) => setFormData({...formData, peso: e.target.value})}
                      placeholder="25 kg, 3.5 kg..."
                    />
                  </div>
                </div>

                <div className="form-row">
                  <div className="form-group">
                    <label>Condici√≥n Corporal *</label>
                    <div className="radio-group">
                      {[1, 2, 3, 4, 5].map(num => (
                        <label key={num} className="radio-label">
                          <input
                            type="radio"
                            name="condicion_corporal"
                            value={num}
                            checked={formData.condicion_corporal === num.toString()}
                            onChange={(e) => setFormData({...formData, condicion_corporal: e.target.value})}
                          />
                          {num}
                        </label>
                      ))}
                    </div>
                  </div>
                </div>

                <div className="form-row">
                  <div className="form-group">
                    <label>Sexo *</label>
                    <div className="radio-group">
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="sexo"
                          value="hembra"
                          checked={formData.sexo === 'hembra'}
                          onChange={(e) => setFormData({...formData, sexo: e.target.value})}
                        />
                        Hembra
                      </label>
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="sexo"
                          value="macho"
                          checked={formData.sexo === 'macho'}
                          onChange={(e) => setFormData({...formData, sexo: e.target.value})}
                        />
                        Macho
                      </label>
                    </div>
                  </div>
                  <div className="form-group">
                    <label>Estado Reproductivo *</label>
                    <div className="radio-group">
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="estado_reproductivo"
                          value="entero"
                          checked={formData.estado_reproductivo === 'entero'}
                          onChange={(e) => setFormData({...formData, estado_reproductivo: e.target.value})}
                        />
                        Entero
                      </label>
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="estado_reproductivo"
                          value="castrado"
                          checked={formData.estado_reproductivo === 'castrado'}
                          onChange={(e) => setFormData({...formData, estado_reproductivo: e.target.value})}
                        />
                        Castrado
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div className="form-section">
                <h3>Historial M√©dico</h3>
                <div className="form-group">
                  <label>Vacunas Vigentes *</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="vacunas_vigentes"
                        value="SI"
                        checked={formData.vacunas_vigentes === 'SI'}
                        onChange={(e) => setFormData({...formData, vacunas_vigentes: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="vacunas_vigentes"
                        value="NO"
                        checked={formData.vacunas_vigentes === 'NO'}
                        onChange={(e) => setFormData({...formData, vacunas_vigentes: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.vacunas_vigentes === 'SI' && (
                    <input
                      type="text"
                      value={formData.vacunas_cual}
                      onChange={(e) => setFormData({...formData, vacunas_cual: e.target.value})}
                      placeholder="¬øCu√°les?"
                      className="mt-2"
                    />
                  )}
                </div>

                <div className="form-group">
                  <label>Desparasitaci√≥n Interna</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="desparasitacion_interna"
                        value="SI"
                        checked={formData.desparasitacion_interna === 'SI'}
                        onChange={(e) => setFormData({...formData, desparasitacion_interna: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="desparasitacion_interna"
                        value="NO"
                        checked={formData.desparasitacion_interna === 'NO'}
                        onChange={(e) => setFormData({...formData, desparasitacion_interna: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.desparasitacion_interna === 'SI' && (
                    <input
                      type="text"
                      value={formData.desparasitacion_interna_cual}
                      onChange={(e) => setFormData({...formData, desparasitacion_interna_cual: e.target.value})}
                      placeholder="¬øCu√°l?"
                      className="mt-2"
                    />
                  )}
                </div>

                <div className="form-group">
                  <label>Desparasitaci√≥n Externa</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="desparasitacion_externa"
                        value="SI"
                        checked={formData.desparasitacion_externa === 'SI'}
                        onChange={(e) => setFormData({...formData, desparasitacion_externa: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="desparasitacion_externa"
                        value="NO"
                        checked={formData.desparasitacion_externa === 'NO'}
                        onChange={(e) => setFormData({...formData, desparasitacion_externa: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.desparasitacion_externa === 'SI' && (
                    <div className="form-row">
                      <div className="form-group">
                        <input
                          type="text"
                          value={formData.desparasitacion_externa_producto}
                          onChange={(e) => setFormData({...formData, desparasitacion_externa_producto: e.target.value})}
                          placeholder="Producto"
                        />
                      </div>
                      <div className="form-group">
                        <input
                          type="date"
                          value={formData.desparasitacion_externa_fecha}
                          onChange={(e) => setFormData({...formData, desparasitacion_externa_fecha: e.target.value})}
                        />
                      </div>
                    </div>
                  )}
                </div>

                <div className="form-group">
                  <label>Cirug√≠as Previas</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="cirugias_previas"
                        value="SI"
                        checked={formData.cirugias_previas === 'SI'}
                        onChange={(e) => setFormData({...formData, cirugias_previas: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="cirugias_previas"
                        value="NO"
                        checked={formData.cirugias_previas === 'NO'}
                        onChange={(e) => setFormData({...formData, cirugias_previas: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.cirugias_previas === 'SI' && (
                    <input
                      type="text"
                      value={formData.cirugias_cual}
                      onChange={(e) => setFormData({...formData, cirugias_cual: e.target.value})}
                      placeholder="¬øCu√°l?"
                      className="mt-2"
                    />
                  )}
                </div>
              </div>

              <div className="form-section">
                <h3>H√°bitat y Alimentaci√≥n</h3>
                <div className="form-group">
                  <label>H√°bitat de la Mascota *</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="habitat"
                        value="INTERIOR"
                        checked={formData.habitat === 'INTERIOR'}
                        onChange={(e) => setFormData({...formData, habitat: e.target.value})}
                      />
                      Interior
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="habitat"
                        value="EXTERIOR"
                        checked={formData.habitat === 'EXTERIOR'}
                        onChange={(e) => setFormData({...formData, habitat: e.target.value})}
                      />
                      Exterior
                    </label>
                  </div>
                </div>

                <div className="form-section-subtitle">
                  <h4>Alimentaci√≥n</h4>
                </div>
                
                <div className="form-row">
                  <div className="form-group">
                    <label>Alimento Seco - Marca</label>
                    <input
                      type="text"
                      value={formData.alimentacion_seco}
                      onChange={(e) => setFormData({...formData, alimentacion_seco: e.target.value})}
                      placeholder="Marca del alimento seco"
                    />
                  </div>
                  <div className="form-group">
                    <label>Alimento H√∫medo - Marca</label>
                    <input
                      type="text"
                      value={formData.alimentacion_humedo}
                      onChange={(e) => setFormData({...formData, alimentacion_humedo: e.target.value})}
                      placeholder="Marca del alimento h√∫medo"
                    />
                  </div>
                </div>

                <div className="form-row">
                  <div className="form-group">
                    <label>Alimentaci√≥n Casera</label>
                    <input
                      type="text"
                      value={formData.alimentacion_casero}
                      onChange={(e) => setFormData({...formData, alimentacion_casero: e.target.value})}
                      placeholder="Descripci√≥n de la alimentaci√≥n casera"
                    />
                  </div>
                  <div className="form-group">
                    <label>Frecuencia de Alimentaci√≥n</label>
                    <input
                      type="text"
                      value={formData.alimentacion_frecuencia}
                      onChange={(e) => setFormData({...formData, alimentacion_frecuencia: e.target.value})}
                      placeholder="Ej: 2 veces al d√≠a"
                    />
                  </div>
                </div>

                <div className="form-group">
                  <label>Paseos</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="paseos"
                        value="SI"
                        checked={formData.paseos === 'SI'}
                        onChange={(e) => setFormData({...formData, paseos: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="paseos"
                        value="NO"
                        checked={formData.paseos === 'NO'}
                        onChange={(e) => setFormData({...formData, paseos: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.paseos === 'SI' && (
                    <input
                      type="text"
                      value={formData.paseos_frecuencia}
                      onChange={(e) => setFormData({...formData, paseos_frecuencia: e.target.value})}
                      placeholder="Frecuencia de paseos"
                      className="mt-2"
                    />
                  )}
                </div>

                <div className="form-group">
                  <label>Ba√±os o Servicio de Est√©tica Reciente</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="ba√±os_estetica"
                        value="SI"
                        checked={formData.ba√±os_estetica === 'SI'}
                        onChange={(e) => setFormData({...formData, ba√±os_estetica: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="ba√±os_estetica"
                        value="NO"
                        checked={formData.ba√±os_estetica === 'NO'}
                        onChange={(e) => setFormData({...formData, ba√±os_estetica: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.ba√±os_estetica === 'SI' && (
                    <input
                      type="date"
                      value={formData.ba√±os_fecha}
                      onChange={(e) => setFormData({...formData, ba√±os_fecha: e.target.value})}
                      className="mt-2"
                    />
                  )}
                </div>
              </div>

              <div className="form-section">
                <h3>Aspecto General de la Mascota</h3>
                <div className="form-row">
                  <div className="form-group">
                    <label>Pelaje</label>
                    <input
                      type="text"
                      value={formData.aspecto_pelaje}
                      onChange={(e) => setFormData({...formData, aspecto_pelaje: e.target.value})}
                      placeholder="Descripci√≥n del pelaje"
                    />
                  </div>
                  <div className="form-group">
                    <label>Piel</label>
                    <input
                      type="text"
                      value={formData.aspecto_piel}
                      onChange={(e) => setFormData({...formData, aspecto_piel: e.target.value})}
                      placeholder="Descripci√≥n de la piel"
                    />
                  </div>
                </div>

                <div className="form-row">
                  <div className="form-group">
                    <label>O√≠dos</label>
                    <input
                      type="text"
                      value={formData.aspecto_oidos}
                      onChange={(e) => setFormData({...formData, aspecto_oidos: e.target.value})}
                      placeholder="Descripci√≥n de los o√≠dos"
                    />
                  </div>
                  <div className="form-group">
                    <label>Ojos</label>
                    <input
                      type="text"
                      value={formData.aspecto_ojos}
                      onChange={(e) => setFormData({...formData, aspecto_ojos: e.target.value})}
                      placeholder="Descripci√≥n de los ojos"
                    />
                  </div>
                </div>

                <div className="form-group">
                  <label>Otros</label>
                  <input
                    type="text"
                    value={formData.aspecto_otros}
                    onChange={(e) => setFormData({...formData, aspecto_otros: e.target.value})}
                    placeholder="Otras observaciones del aspecto general"
                  />
                </div>
              </div>

              <div className="form-section">
                <h3>Historial Reportado</h3>
                
                <div className="form-row">
                  <div className="form-group">
                    <label>V√≥mito</label>
                    <div className="radio-group">
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="vomito"
                          value="SI"
                          checked={formData.vomito === 'SI'}
                          onChange={(e) => setFormData({...formData, vomito: e.target.value})}
                        />
                        S√≠
                      </label>
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="vomito"
                          value="NO"
                          checked={formData.vomito === 'NO'}
                          onChange={(e) => setFormData({...formData, vomito: e.target.value})}
                        />
                        No
                      </label>
                    </div>
                    {formData.vomito === 'SI' && (
                      <div className="form-row">
                        <div className="form-group">
                          <input
                            type="text"
                            value={formData.vomito_color}
                            onChange={(e) => setFormData({...formData, vomito_color: e.target.value})}
                            placeholder="Color"
                            className="mt-2"
                          />
                        </div>
                        <div className="form-group">
                          <input
                            type="text"
                            value={formData.vomito_aspecto}
                            onChange={(e) => setFormData({...formData, vomito_aspecto: e.target.value})}
                            placeholder="Aspecto"
                            className="mt-2"
                          />
                        </div>
                      </div>
                    )}
                  </div>

                  <div className="form-group">
                    <label>Diarrea</label>
                    <div className="radio-group">
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="diarrea"
                          value="SI"
                          checked={formData.diarrea === 'SI'}
                          onChange={(e) => setFormData({...formData, diarrea: e.target.value})}
                        />
                        S√≠
                      </label>
                      <label className="radio-label">
                        <input
                          type="radio"
                          name="diarrea"
                          value="NO"
                          checked={formData.diarrea === 'NO'}
                          onChange={(e) => setFormData({...formData, diarrea: e.target.value})}
                        />
                        No
                      </label>
                    </div>
                    {formData.diarrea === 'SI' && (
                      <div className="form-row">
                        <div className="form-group">
                          <input
                            type="text"
                            value={formData.diarrea_color}
                            onChange={(e) => setFormData({...formData, diarrea_color: e.target.value})}
                            placeholder="Color"
                            className="mt-2"
                          />
                        </div>
                        <div className="form-group">
                          <input
                            type="text"
                            value={formData.diarrea_aspecto}
                            onChange={(e) => setFormData({...formData, diarrea_aspecto: e.target.value})}
                            placeholder="Aspecto"
                            className="mt-2"
                          />
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                <div className="form-group">
                  <label>Dientes</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="dientes"
                        value="limpios"
                        checked={formData.dientes === 'limpios'}
                        onChange={(e) => setFormData({...formData, dientes: e.target.value})}
                      />
                      Limpios
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="dientes"
                        value="placas"
                        checked={formData.dientes === 'placas'}
                        onChange={(e) => setFormData({...formData, dientes: e.target.value})}
                      />
                      Placas
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="dientes"
                        value="gingivitis"
                        checked={formData.dientes === 'gingivitis'}
                        onChange={(e) => setFormData({...formData, dientes: e.target.value})}
                      />
                      Gingivitis
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="dientes"
                        value="periodontitis"
                        checked={formData.dientes === 'periodontitis'}
                        onChange={(e) => setFormData({...formData, dientes: e.target.value})}
                      />
                      Periodontitis
                    </label>
                  </div>
                  <input
                    type="text"
                    value={formData.dientes_otros}
                    onChange={(e) => setFormData({...formData, dientes_otros: e.target.value})}
                    placeholder="Otros (especificar)"
                    className="mt-2"
                  />
                </div>

                <div className="form-row">
                  <div className="form-group">
                    <label>√öltima Comida</label>
                    <input
                      type="text"
                      value={formData.ultima_comida}
                      onChange={(e) => setFormData({...formData, ultima_comida: e.target.value})}
                      placeholder="Descripci√≥n de la √∫ltima comida"
                    />
                  </div>
                  <div className="form-group">
                    <label>Fecha de √öltima Comida</label>
                    <input
                      type="datetime-local"
                      value={formData.ultima_comida_fecha}
                      onChange={(e) => setFormData({...formData, ultima_comida_fecha: e.target.value})}
                    />
                  </div>
                </div>

                <div className="form-group">
                  <label>L√≠quidos</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="liquidos"
                        value="SI"
                        checked={formData.liquidos === 'SI'}
                        onChange={(e) => setFormData({...formData, liquidos: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="liquidos"
                        value="NO"
                        checked={formData.liquidos === 'NO'}
                        onChange={(e) => setFormData({...formData, liquidos: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.liquidos === 'SI' && (
                    <input
                      type="text"
                      value={formData.liquidos_cantidad}
                      onChange={(e) => setFormData({...formData, liquidos_cantidad: e.target.value})}
                      placeholder="Cantidad"
                      className="mt-2"
                    />
                  )}
                </div>

                <div className="form-group">
                  <label>Actividad General</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="actividad_general"
                        value="ACTIVO"
                        checked={formData.actividad_general === 'ACTIVO'}
                        onChange={(e) => setFormData({...formData, actividad_general: e.target.value})}
                      />
                      Activo
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="actividad_general"
                        value="PASIVO"
                        checked={formData.actividad_general === 'PASIVO'}
                        onChange={(e) => setFormData({...formData, actividad_general: e.target.value})}
                      />
                      Pasivo
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="actividad_general"
                        value="DECAIDO"
                        checked={formData.actividad_general === 'DECAIDO'}
                        onChange={(e) => setFormData({...formData, actividad_general: e.target.value})}
                      />
                      Deca√≠do
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="actividad_general"
                        value="ALETARGADO"
                        checked={formData.actividad_general === 'ALETARGADO'}
                        onChange={(e) => setFormData({...formData, actividad_general: e.target.value})}
                      />
                      Aletargado
                    </label>
                  </div>
                </div>

                <div className="form-group">
                  <label>Medicamentos Administrados</label>
                  <div className="radio-group">
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="medicamentos"
                        value="SI"
                        checked={formData.medicamentos === 'SI'}
                        onChange={(e) => setFormData({...formData, medicamentos: e.target.value})}
                      />
                      S√≠
                    </label>
                    <label className="radio-label">
                      <input
                        type="radio"
                        name="medicamentos"
                        value="NO"
                        checked={formData.medicamentos === 'NO'}
                        onChange={(e) => setFormData({...formData, medicamentos: e.target.value})}
                      />
                      No
                    </label>
                  </div>
                  {formData.medicamentos === 'SI' && (
                    <input
                      type="text"
                      value={formData.medicamentos_cual}
                      onChange={(e) => setFormData({...formData, medicamentos_cual: e.target.value})}
                      placeholder="¬øCu√°l?"
                      className="mt-2"
                    />
                  )}
                </div>
              </div>

              <div className="form-actions">
                <button
                  type="submit"
                  disabled={loading || !selectedCategory}
                  className="btn btn-primary btn-large"
                >
                  {loading ? 'Guardando...' : 'Continuar al Paso 2'}
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    );
  }

  if (step === 2) {
    return (
      <div className="consultation-page">
        <Header setView={setView} />
        
        <div className="container">
          {error && <div className="error-message">{error}</div>}

          <div className="consultation-form-container">
            <div className="step-indicator">
              <div className="step completed">1. Datos de la Mascota</div>
              <div className="step active">2. Motivo de Consulta</div>
              <div className="step">3. An√°lisis Diagn√≥stico</div>
            </div>

            <form onSubmit={handleSubmitStep2} className="consultation-form">
              <div className="form-section">
                <h3>Detalle del Paciente</h3>
                <div className="form-group">
                  <label>ANOTA CON EL MAYOR DETALLE LOS DATOS SOBRE EL PACIENTE. *SEA MUY ESPEC√çFICO</label>
                  <textarea
                    required
                    rows={20}
                    value={formData.detalle_paciente}
                    onChange={(e) => setFormData({...formData, detalle_paciente: e.target.value})}
                    placeholder="Escriba aqu√≠ todos los detalles sobre el paciente, motivo de consulta, s√≠ntomas, observaciones cl√≠nicas, signos vitales, tratamientos previos, historia cl√≠nica, estudios realizados, comportamiento, y cualquier otra informaci√≥n relevante para el diagn√≥stico..."
                    style={{
                      minHeight: '400px',
                      fontSize: '16px',
                      lineHeight: '1.6',
                      padding: '20px'
                    }}
                  />
                </div>
              </div>

              <div className="form-actions">
                <button type="submit" disabled={loading} className="btn btn-primary btn-large">
                  {loading ? 'Guardando...' : 'Continuar al An√°lisis'}
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    );
  }

  if (step === 3) {
    return (
      <div className="consultation-page">
        <Header setView={setView} />
        
        <div className="container">
          {error && <div className="error-message">{error}</div>}

          <div className="consultation-form-container">
            <div className="step-indicator">
              <div className="step completed">1. Datos de la Mascota</div>
              <div className="step completed">2. Motivo de Consulta</div>
              <div className="step active">3. An√°lisis Diagn√≥stico</div>
            </div>

            <div className="ai-analysis-section">
              {!aiAnalysis ? (
                <div className="analysis-prompt">
                  <div className="analysis-icon">ü§ñ</div>
                  <h3>¬øListo para el an√°lisis especializado?</h3>
                  <p>
                    Nuestro sistema especializado en {categories[selectedCategory]?.name} 
                    analizar√° toda la informaci√≥n proporcionada para generar:
                  </p>
                  <ul>
                    <li>Diagn√≥sticos diferenciales</li>
                    <li>Plan de tratamiento detallado</li>
                    <li>Estudios complementarios recomendados</li>
                    <li>Pron√≥stico</li>
                    <li>Referencias bibliogr√°ficas</li>
                  </ul>
                  
                  <button
                    onClick={handleAIAnalysis}
                    disabled={loading}
                    className="btn btn-primary btn-large"
                  >
                    {loading ? 'Analizando...' : 'Iniciar An√°lisis'}
                  </button>
                </div>
              ) : (
                <div className="analysis-result">
                  <h3>An√°lisis Veterinario Especializado</h3>
                  <div className="analysis-content">
                    <pre className="analysis-text">{aiAnalysis}</pre>
                  </div>
                  
                  <div className="analysis-actions">
                    <button
                      onClick={() => setView('consultation-history')}
                      className="btn btn-primary"
                    >
                      Ver en Historial
                    </button>
                    <button
                      onClick={() => {
                        setStep(1);
                        setConsultationId(null);
                        setAiAnalysis(null);
                        setFormData({
                          fecha: new Date().toISOString().split('T')[0],
                          nombre_mascota: '', nombre_due√±o: '', raza: '', mix: '',
                          edad: '', peso: '', condicion_corporal: '3', sexo: '', estado_reproductivo: '',
                          vacunas_vigentes: '', vacunas_cual: '', desparasitacion_interna: '',
                          desparasitacion_interna_cual: '', desparasitacion_externa: '',
                          desparasitacion_externa_producto: '', desparasitacion_externa_fecha: '',
                          habitat: '', zona_geografica: '', alimentacion_seco: '', alimentacion_humedo: '',
                          alimentacion_casero: '', alimentacion_frecuencia: '', paseos: '',
                          paseos_frecuencia: '', ba√±os_estetica: '', ba√±os_fecha: '',
                          cirugias_previas: '', cirugias_cual: '', aspecto_pelaje: '',
                          aspecto_piel: '', aspecto_oidos: '', aspecto_ojos: '', aspecto_otros: '',
                          vomito: 'NO', vomito_color: '', vomito_aspecto: '', diarrea: 'NO',
                          diarrea_color: '', diarrea_aspecto: '', orina: 'NO', orina_color: '',
                          orina_olor: '', secrecion_nasal: 'NO', secrecion_nasal_color: '',
                          secrecion_nasal_aspecto: '', secrecion_ocular: 'NO', secrecion_ocular_color: '',
                          dientes: 'limpios', dientes_otros: '', piel_condicion: 'normal',
                          ultima_comida: '', ultima_comida_fecha: '', liquidos: '',
                          liquidos_cantidad: '', actividad_general: 'ACTIVO', medicamentos: 'NO',
                          medicamentos_cual: '', detalle_paciente: ''
                        });
                        setSelectedCategory('');
                      }}
                      className="btn btn-secondary"
                    >
                      Nueva Consulta
                    </button>
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
    );
  }
};

// Consultation History
const ConsultationHistory = ({ setView }) => {
  const { veterinarian } = useVet();
  const [consultations, setConsultations] = useState([]);
  const [filteredConsultations, setFilteredConsultations] = useState([]);
  const [loading, setLoading] = useState(true);
  const [selectedConsultation, setSelectedConsultation] = useState(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [searching, setSearching] = useState(false);

  useEffect(() => {
    loadConsultations();
  }, []);

  useEffect(() => {
    if (searchQuery.length >= 2) {
      handleSearch(searchQuery);
    } else {
      setFilteredConsultations(consultations);
    }
  }, [searchQuery, consultations]);

  const loadConsultations = async () => {
    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/consultations/${veterinarian.id}/history`);
      if (response.ok) {
        const data = await response.json();
        setConsultations(data.consultations || []);
        setFilteredConsultations(data.consultations || []);
      }
    } catch (error) {
      console.error('Error loading consultations:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleSearch = async (query) => {
    if (query.length < 2) {
      setFilteredConsultations(consultations);
      return;
    }

    setSearching(true);
    try {
      const response = await fetch(
        `${process.env.REACT_APP_BACKEND_URL}/api/consultations/${veterinarian.id}/search?query=${encodeURIComponent(query)}`
      );
      if (response.ok) {
        const data = await response.json();
        setFilteredConsultations(data.consultations || []);
      }
    } catch (error) {
      console.error('Error searching consultations:', error);
    } finally {
      setSearching(false);
    }
  };

  const handleViewConsultation = async (consultationId) => {
    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/consultations/${consultationId}`);
      if (response.ok) {
        const consultation = await response.json();
        setSelectedConsultation(consultation);
      }
    } catch (error) {
      console.error('Error loading consultation details:', error);
    }
  };

  if (selectedConsultation) {
    return (
      <div className="consultation-detail-page">
        <Header setView={setView} />
        
        <div className="container">
          <div className="consultation-header">
            <button onClick={() => setSelectedConsultation(null)} className="back-btn">
              ‚Üê Volver al Historial
            </button>
            <div className="consultation-id-badge">
              ID: {selectedConsultation.consultation_number || 'N/A'}
            </div>
            <h1>Detalle de Consulta</h1>
            <p>Consulta del {new Date(selectedConsultation.created_at).toLocaleDateString()}</p>
          </div>

          <div className="consultation-detail">
            <div className="detail-section">
              <h3>üêæ Informaci√≥n del Paciente</h3>
              <div className="detail-grid">
                <div className="detail-item">
                  <strong>Nombre:</strong> {selectedConsultation.nombre_mascota}
                </div>
                <div className="detail-item">
                  <strong>Propietario:</strong> {selectedConsultation.nombre_dueno}
                </div>
                <div className="detail-item">
                  <strong>Raza:</strong> {selectedConsultation.raza}
                </div>
                <div className="detail-item">
                  <strong>Edad:</strong> {selectedConsultation.edad}
                </div>
                <div className="detail-item">
                  <strong>Peso:</strong> {selectedConsultation.peso}
                </div>
                <div className="detail-item">
                  <strong>Sexo:</strong> {selectedConsultation.sexo}
                </div>
                <div className="detail-item">
                  <strong>Estado Reproductivo:</strong> {selectedConsultation.estado_reproductivo}
                </div>
                <div className="detail-item">
                  <strong>Condici√≥n Corporal:</strong> {selectedConsultation.condicion_corporal}
                </div>
              </div>
            </div>

            <div className="detail-section">
              <h3>üìã Detalle del Paciente</h3>
              <div className="detail-text">
                {selectedConsultation.detalle_paciente}
              </div>
            </div>

            {selectedConsultation.ai_analysis && (
              <div className="detail-section analysis-section">
                <h3>ü§ñ An√°lisis Especializado</h3>
                <div className="analysis-content">
                  <pre className="analysis-text">{selectedConsultation.ai_analysis}</pre>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="history-page">
      <Header setView={setView} />
      
      <div className="container">
        <div className="page-header">
          <h1>Historial de Consultas</h1>
          <p>Todas tus consultas veterinarias realizadas</p>
        </div>

        <div className="search-bar">
          <div className="search-input-wrapper">
            <span className="search-icon">üîç</span>
            <input
              type="text"
              placeholder="Buscar por ID (CONS-0001), nombre de mascota, propietario o raza..."
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              className="search-input"
            />
            {searchQuery && (
              <button 
                className="clear-search-btn"
                onClick={() => setSearchQuery('')}
              >
                ‚úï
              </button>
            )}
          </div>
          <button onClick={() => setView('new-consultation')} className="btn btn-primary">
            Nueva Consulta
          </button>
        </div>

        {searching && (
          <div className="searching-indicator">Buscando...</div>
        )}

        {loading ? (
          <div className="loading-state">Cargando historial...</div>
        ) : filteredConsultations.length > 0 ? (
          <div className="consultations-grid">
            {filteredConsultations.map((consultation) => (
              <div key={consultation.id} className="consultation-card">
                <div className="consultation-id-header">
                  <span className="consultation-id">
                    {consultation.consultation_number || 'ID-N/A'}
                  </span>
                </div>
                <div className="consultation-header">
                  <h3>üêæ {consultation.nombre_mascota || 'Sin nombre'}</h3>
                  <span className="consultation-date">
                    {new Date(consultation.created_at || consultation.fecha).toLocaleDateString('es-MX', {
                      year: 'numeric',
                      month: 'long',
                      day: 'numeric'
                    })}
                  </span>
                </div>
                
                <div className="consultation-content">
                  <div className="detail-row">
                    <strong>Propietario:</strong> {consultation.nombre_dueno || 'No especificado'}
                  </div>
                  <div className="detail-row">
                    <strong>Raza:</strong> {consultation.raza || 'No especificada'}
                  </div>
                  <div className="detail-row">
                    <strong>Edad:</strong> {consultation.edad || 'No especificada'}
                  </div>
                  <div className="detail-row">
                    <strong>Motivo:</strong> {consultation.detalle_paciente ? 
                      consultation.detalle_paciente.substring(0, 80) + '...' : 
                      'Sin detalles'}
                  </div>
                </div>
                
                <div className="consultation-actions">
                  <button
                    onClick={() => handleViewConsultation(consultation.id)}
                    className="btn btn-secondary"
                  >
                    Ver An√°lisis Completo
                  </button>
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div className="empty-state">
            <div className="empty-icon">üìã</div>
            <h3>{searchQuery ? 'No se encontraron consultas' : 'No hay consultas a√∫n'}</h3>
            <p>{searchQuery ? 'Intenta con otro t√©rmino de b√∫squeda' : 'Comienza creando tu primera consulta veterinaria'}</p>
            {!searchQuery && (
              <button onClick={() => setView('new-consultation')} className="btn btn-primary">
                Crear Primera Consulta
              </button>
            )}
          </div>
        )}
      </div>
    </div>
  );
};



// Medical Image Interpretation Component (Premium Only)
const MedicalImageInterpretation = ({ setView }) => {
  const { veterinarian } = useVet();
  const [imageType, setImageType] = useState('xray');
  const [imageFile, setImageFile] = useState(null);
  const [imagePreview, setImagePreview] = useState('');
  const [patientName, setPatientName] = useState('');
  const [additionalContext, setAdditionalContext] = useState('');
  const [consultationId, setConsultationId] = useState('');
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState(null);
  const [error, setError] = useState('');
  const [history, setHistory] = useState([]);
  const [showHistory, setShowHistory] = useState(false);

  useEffect(() => {
    if (veterinarian.membership_type?.toLowerCase() !== 'premium') {
      setError('Esta funci√≥n es exclusiva para miembros Premium');
    } else {
      loadHistory();
    }
  }, [veterinarian]);

  const loadHistory = async () => {
    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/medical-images/history/${veterinarian.id}`);
      if (response.ok) {
        const data = await response.json();
        setHistory(data.interpretations || []);
      }
    } catch (error) {
      console.error('Error loading history:', error);
    }
  };

  const handleImageChange = (e) => {
    const file = e.target.files[0];
    if (file) {
      if (file.size > 10 * 1024 * 1024) {
        setError('La imagen es demasiado grande. M√°ximo 10MB.');
        return;
      }
      
      setImageFile(file);
      const reader = new FileReader();
      reader.onloadend = () => {
        setImagePreview(reader.result);
      };
      reader.readAsDataURL(file);
      setError('');
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    if (!imageFile) {
      setError('Por favor selecciona una imagen');
      return;
    }

    setLoading(true);
    setError('');
    setResult(null);

    try {
      // Convert image to base64
      const reader = new FileReader();
      reader.readAsDataURL(imageFile);
      
      reader.onload = async () => {
        const base64String = reader.result.split(',')[1];
        
        const requestData = {
          veterinarian_id: veterinarian.id,
          image_base64: base64String,
          image_type: imageType,
          patient_name: patientName || null,
          consultation_id: consultationId || null,
          additional_context: additionalContext || null
        };

        const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/medical-images/interpret`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(requestData)
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.detail || 'Error al interpretar imagen');
        }

        const data = await response.json();
        setResult(data);
        loadHistory();
        
        // Clear form
        setImageFile(null);
        setImagePreview('');
        setPatientName('');
        setAdditionalContext('');
        setConsultationId('');
      };
      
      reader.onerror = () => {
        throw new Error('Error al leer la imagen');
      };
      
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  if (veterinarian.membership_type?.toLowerCase() !== 'premium') {
    return (
      <div className="medical-images-page">
        <Header setView={setView} />
        <div className="container">
          <div className="premium-required">
            <div className="premium-icon">üîí</div>
            <h2>Funci√≥n Premium Requerida</h2>
            <p>La interpretaci√≥n de im√°genes m√©dicas con IA est√° disponible exclusivamente para miembros Premium.</p>
            <button onClick={() => setView('membership')} className="btn btn-primary">
              Ver Planes Premium
            </button>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="medical-images-page">
      <Header setView={setView} />
      
      <div className="container">
        <div className="page-header">
          <h1>üî¨ Interpretaci√≥n de Im√°genes M√©dicas</h1>
          <p>An√°lisis con IA de rayos X, pruebas de laboratorio y urian√°lisis</p>
          <button onClick={() => setShowHistory(!showHistory)} className="btn btn-secondary">
            {showHistory ? 'Nueva Interpretaci√≥n' : 'Ver Historial'}
          </button>
        </div>

        {!showHistory ? (
          <div className="image-interpretation-form">
            <form onSubmit={handleSubmit}>
              <div className="form-section">
                <h3>Tipo de Imagen</h3>
                <div className="image-type-selector">
                  <label className={`type-option ${imageType === 'xray' ? 'selected' : ''}`}>
                    <input
                      type="radio"
                      value="xray"
                      checked={imageType === 'xray'}
                      onChange={(e) => setImageType(e.target.value)}
                    />
                    <div className="type-content">
                      <div className="type-icon">üì∑</div>
                      <span>Rayos X</span>
                    </div>
                  </label>
                  
                  <label className={`type-option ${imageType === 'blood_test' ? 'selected' : ''}`}>
                    <input
                      type="radio"
                      value="blood_test"
                      checked={imageType === 'blood_test'}
                      onChange={(e) => setImageType(e.target.value)}
                    />
                    <div className="type-content">
                      <div className="type-icon">ü©∏</div>
                      <span>An√°lisis de Sangre</span>
                    </div>
                  </label>
                  
                  <label className={`type-option ${imageType === 'urinalysis' ? 'selected' : ''}`}>
                    <input
                      type="radio"
                      value="urinalysis"
                      checked={imageType === 'urinalysis'}
                      onChange={(e) => setImageType(e.target.value)}
                    />
                    <div className="type-content">
                      <div className="type-icon">üß™</div>
                      <span>Urian√°lisis</span>
                    </div>
                  </label>
                </div>
              </div>

              <div className="form-section">
                <h3>Cargar Imagen</h3>
                <div className="image-upload-area">
                  <input
                    type="file"
                    accept="image/*"
                    onChange={handleImageChange}
                    className="file-input"
                    id="image-upload"
                  />
                  <label htmlFor="image-upload" className="file-upload-label">
                    {imagePreview ? (
                      <img src={imagePreview} alt="Preview" className="image-preview" />
                    ) : (
                      <div className="upload-placeholder">
                        <div className="upload-icon">üìÅ</div>
                        <p>Click para seleccionar imagen</p>
                        <small>JPG, PNG - M√°ximo 10MB</small>
                      </div>
                    )}
                  </label>
                </div>
              </div>

              <div className="form-row">
                <div className="form-group">
                  <label>Nombre del Paciente (Opcional)</label>
                  <input
                    type="text"
                    value={patientName}
                    onChange={(e) => setPatientName(e.target.value)}
                    placeholder="Ej: Max, Luna, Rocky"
                  />
                </div>
                
                <div className="form-group">
                  <label>ID de Consulta Previa (Opcional)</label>
                  <input
                    type="text"
                    value={consultationId}
                    onChange={(e) => setConsultationId(e.target.value)}
                    placeholder="Para incluir historial del paciente"
                  />
                </div>
              </div>

              <div className="form-group">
                <label>Contexto Adicional (Opcional)</label>
                <textarea
                  value={additionalContext}
                  onChange={(e) => setAdditionalContext(e.target.value)}
                  placeholder="Informaci√≥n adicional relevante para la interpretaci√≥n..."
                  rows="4"
                />
              </div>

              {error && <div className="error-message">{error}</div>}

              <div className="form-actions">
                <button type="button" onClick={() => setView('dashboard')} className="btn btn-secondary">
                  Cancelar
                </button>
                <button type="submit" disabled={loading || !imageFile} className="btn btn-primary">
                  {loading ? 'Analizando...' : 'Interpretar Imagen'}
                </button>
              </div>
            </form>

            {result && (
              <div className="interpretation-result">
                <h2>Resultado de la Interpretaci√≥n</h2>
                
                <div className="result-section">
                  <h3>üîç Hallazgos Principales</h3>
                  <div className="result-content">
                    {result.findings || 'Ver an√°lisis detallado abajo'}
                  </div>
                </div>

                <div className="result-section">
                  <h3>üíä Recomendaciones</h3>
                  <div className="result-content">
                    {result.recommendations || 'Ver an√°lisis detallado abajo'}
                  </div>
                </div>

                <div className="result-section detailed">
                  <h3>üìä An√°lisis Detallado</h3>
                  <div className="result-content detailed-analysis">
                    <pre>{result.detailed_analysis}</pre>
                  </div>
                </div>

                <div className="result-actions">
                  <button onClick={() => setResult(null)} className="btn btn-secondary">
                    Nueva Interpretaci√≥n
                  </button>
                  <button onClick={() => setShowHistory(true)} className="btn btn-primary">
                    Ver Historial
                  </button>
                </div>
              </div>
            )}
          </div>
        ) : (
          <div className="interpretation-history">
            <h2>Historial de Interpretaciones</h2>
            {history.length > 0 ? (
              <div className="history-grid">
                {history.map((item) => (
                  <div key={item.id} className="history-card">
                    <div className="history-header">
                      <div className="history-type">
                        {item.image_type === 'xray' && 'üì∑ Rayos X'}
                        {item.image_type === 'blood_test' && 'ü©∏ An√°lisis de Sangre'}
                        {item.image_type === 'urinalysis' && 'üß™ Urian√°lisis'}
                      </div>
                      <div className="history-date">
                        {new Date(item.created_at).toLocaleDateString('es-MX', {
                          year: 'numeric',
                          month: 'long',
                          day: 'numeric'
                        })}
                      </div>
                    </div>
                    {item.patient_name && (
                      <div className="history-patient">
                        <strong>Paciente:</strong> {item.patient_name}
                      </div>
                    )}
                    <div className="history-preview">
                      {item.findings ? item.findings.substring(0, 150) + '...' : item.detailed_analysis.substring(0, 150) + '...'}
                    </div>
                    <button 
                      onClick={() => {
                        setResult(item);
                        setShowHistory(false);
                      }} 
                      className="btn btn-secondary btn-sm"
                    >
                      Ver Completo
                    </button>
                  </div>
                ))}
              </div>
            ) : (
              <div className="empty-state">
                <div className="empty-icon">üî¨</div>
                <h3>No hay interpretaciones a√∫n</h3>
                <p>Comienza subiendo tu primera imagen m√©dica</p>
                <button onClick={() => setShowHistory(false)} className="btn btn-primary">
                  Nueva Interpretaci√≥n
                </button>
              </div>
            )}
          </div>
        )}
      </div>
    </div>
  );
};

// Membership Page
const MembershipPage = ({ setView }) => {
  const { veterinarian } = useVet();
  const [packages, setPackages] = useState({});
  const [loading, setLoading] = useState(false);
  const [billingCycle, setBillingCycle] = useState('monthly'); // 'monthly' or 'annual'

  useEffect(() => {
    loadPackages();
  }, []);

  const loadPackages = async () => {
    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/membership/packages`);
      if (response.ok) {
        const data = await response.json();
        setPackages(data.packages);
      }
    } catch (error) {
      console.error('Error loading packages:', error);
    }
  };

  const handlePurchase = async (packageId) => {
    setLoading(true);
    
    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/payments/checkout/session`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          package_id: packageId,
          origin_url: window.location.origin,
          billing_cycle: billingCycle
        })
      });

      if (!response.ok) {
        throw new Error('Error creando sesi√≥n de pago');
      }

      const data = await response.json();
      window.location.href = data.checkout_url;
    } catch (error) {
      console.error('Error:', error);
      alert('Error procesando el pago. Int√©ntalo de nuevo.');
    } finally {
      setLoading(false);
    }
  };

  const getMembershipStatus = () => {
    if (!veterinarian.membership_type) {
      return { text: 'Sin membres√≠a activa', color: 'red' };
    }
    
    const expiry = veterinarian.membership_expires ? 
      new Date(veterinarian.membership_expires) : null;
    
    if (expiry && expiry < new Date()) {
      return { text: 'Membres√≠a expirada', color: 'red' };
    }

    const remaining = veterinarian.consultations_remaining || 0;
    const packageName = packages[veterinarian.membership_type]?.name || veterinarian.membership_type;
    
    return {
      text: `${packageName} - ${remaining === 999999 ? 'Ilimitadas' : remaining} consultas`,
      color: remaining > 5 || remaining === 999999 ? 'green' : remaining > 0 ? 'orange' : 'red'
    };
  };

  const status = getMembershipStatus();

  return (
    <div className="membership-page">
      <Header setView={setView} />
      
      <div className="container">
        <div className="page-header">
          <h1>Membres√≠as Savant Vet</h1>
          <p>Elige el plan que mejor se adapte a tus necesidades</p>
          <div className="current-status" style={{color: status.color}}>
            Estado actual: {status.text}
          </div>
        </div>

        <div className="billing-toggle" style={{textAlign: 'center', margin: '30px 0'}}>
          <button 
            onClick={() => setBillingCycle('monthly')} 
            className={`toggle-btn ${billingCycle === 'monthly' ? 'active' : ''}`}
            style={{
              padding: '10px 30px',
              margin: '0 10px',
              border: billingCycle === 'monthly' ? '2px solid #4CAF50' : '1px solid #ccc',
              borderRadius: '25px',
              background: billingCycle === 'monthly' ? '#4CAF50' : 'white',
              color: billingCycle === 'monthly' ? 'white' : '#333',
              cursor: 'pointer',
              fontSize: '16px',
              fontWeight: '600'
            }}
          >
            Mensual
          </button>
          <button 
            onClick={() => setBillingCycle('annual')} 
            className={`toggle-btn ${billingCycle === 'annual' ? 'active' : ''}`}
            style={{
              padding: '10px 30px',
              margin: '0 10px',
              border: billingCycle === 'annual' ? '2px solid #4CAF50' : '1px solid #ccc',
              borderRadius: '25px',
              background: billingCycle === 'annual' ? '#4CAF50' : 'white',
              color: billingCycle === 'annual' ? 'white' : '#333',
              cursor: 'pointer',
              fontSize: '16px',
              fontWeight: '600'
            }}
          >
            Anual 
            <span style={{fontSize: '12px', display: 'block'}}>
              (2 meses GRATIS üéÅ)
            </span>
          </button>
        </div>

        <div className="pricing-grid">
          {Object.entries(packages).map(([key, pkg]) => {
            const price = billingCycle === 'annual' ? pkg.price_annual : pkg.price_monthly;
            const periodText = billingCycle === 'annual' ? 'MXN/a√±o' : 'MXN/mes';
            const monthlyEquivalent = billingCycle === 'annual' ? (pkg.price_annual / 12).toFixed(2) : null;
            
            return (
              <div key={key} className={`pricing-card ${veterinarian.membership_type === key ? 'current' : ''}`}>
                <div className="pricing-header">
                  <h3>{pkg.name}</h3>
                  <div className="price">
                    <span className="currency">$</span>
                    <span className="amount">{price}</span>
                    <span className="period">{periodText}</span>
                  </div>
                  {billingCycle === 'annual' && (
                    <div style={{fontSize: '14px', color: '#4CAF50', marginTop: '5px'}}>
                      ‚âà ${monthlyEquivalent} MXN/mes
                    </div>
                  )}
                </div>
              
              <div className="pricing-features">
                <div className="feature">
                  ‚úÖ {pkg.consultations === 'unlimited' ? 'Consultas ilimitadas' : `${pkg.consultations} consultas/mes`}
                </div>
                <div className="feature">
                  ‚úÖ Sistema especializado por categor√≠a
                </div>
                <div className="feature">
                  ‚úÖ Diagn√≥sticos diferenciales
                </div>
                <div className="feature">
                  ‚úÖ Planes de tratamiento
                </div>
                <div className="feature">
                  ‚úÖ Referencias bibliogr√°ficas
                </div>
                {key === 'professional' && (
                  <>
                    <div className="feature">
                      ‚úÖ Soporte prioritario
                    </div>
                    <div className="feature">
                      ‚úÖ Historial extendido
                    </div>
                  </>
                )}
                {key === 'premium' && (
                  <>
                    <div className="feature">
                      ‚úÖ Soporte 24/7
                    </div>
                    <div className="feature">
                      ‚úÖ Consultas ilimitadas
                    </div>
                    <div className="feature">
                      ‚úÖ Contenido exclusivo
                    </div>
                    <div className="feature">
                      ‚úÖ An√°lisis avanzados
                    </div>
                  </>
                )}
              </div>
              
              <button
                onClick={() => handlePurchase(key)}
                disabled={loading || veterinarian.membership_type === key}
                className={`btn ${key === 'premium' ? 'btn-primary' : 'btn-secondary'} btn-full`}
              >
                {veterinarian.membership_type === key ? 'Plan Actual' : 
                 loading ? 'Procesando...' : 'Seleccionar Plan'}
              </button>
            </div>
            );
          })}
        </div>

        <div className="membership-info">
          <h2>¬øPor qu√© elegir una membres√≠a?</h2>
          <div className="info-grid">
            <div className="info-card">
              <div className="info-icon">üî¨</div>
              <h3>Sistema Especializado</h3>
              <p>An√°lisis especializados entrenados espec√≠ficamente para cada categor√≠a animal</p>
            </div>
            <div className="info-card">
              <div className="info-icon">‚ö°</div>
              <h3>Resultados R√°pidos</h3>
              <p>An√°lisis completo en minutos, no en horas</p>
            </div>
            <div className="info-card">
              <div className="info-icon">üìö</div>
              <h3>Basado en Evidencia</h3>
              <p>Recomendaciones respaldadas por literatura cient√≠fica actualizada</p>
            </div>
            <div className="info-card">
              <div className="info-icon">üîÑ</div>
              <h3>Actualizaci√≥n Continua</h3>
              <p>Sistema en constante mejora con nuevos avances veterinarios</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// Payment Success Page
const PaymentSuccess = ({ setView }) => {
  const [paymentStatus, setPaymentStatus] = useState('checking');
  const [sessionId, setSessionId] = useState(null);

  useEffect(() => {
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('session_id');
    
    if (id) {
      setSessionId(id);
      pollPaymentStatus(id);
    } else {
      setPaymentStatus('error');
    }
  }, []);

  const pollPaymentStatus = async (sessionId, attempts = 0) => {
    const maxAttempts = 5;
    
    if (attempts >= maxAttempts) {
      setPaymentStatus('timeout');
      return;
    }

    try {
      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/payments/checkout/status/${sessionId}`);
      
      if (!response.ok) {
        throw new Error('Error verificando pago');
      }

      const data = await response.json();
      
      if (data.payment_status === 'paid') {
        setPaymentStatus('success');
        return;
      } else if (data.status === 'expired') {
        setPaymentStatus('expired');
        return;
      }

      // Continue polling
      setTimeout(() => pollPaymentStatus(sessionId, attempts + 1), 2000);
    } catch (error) {
      console.error('Error checking payment:', error);
      setPaymentStatus('error');
    }
  };

  return (
    <div className="payment-success-page">
      <Header setView={setView} />
      
      <div className="container">
        <div className="payment-status-container">
          {paymentStatus === 'checking' && (
            <div className="status-card">
              <div className="status-icon loading">‚è≥</div>
              <h2>Verificando Pago</h2>
              <p>Estamos procesando tu pago, esto puede tomar unos momentos...</p>
            </div>
          )}

          {paymentStatus === 'success' && (
            <div className="status-card success">
              <div className="status-icon">‚úÖ</div>
              <h2>¬°Pago Exitoso!</h2>
              <p>Tu membres√≠a ha sido activada correctamente. Ya puedes comenzar a usar todas las funciones de Savant Vet.</p>
              <div className="status-actions">
                <button onClick={() => setView('dashboard')} className="btn btn-primary">
                  Ir al Dashboard
                </button>
                <button onClick={() => setView('new-consultation')} className="btn btn-secondary">
                  Nueva Consulta
                </button>
              </div>
            </div>
          )}

          {paymentStatus === 'error' && (
            <div className="status-card error">
              <div className="status-icon">‚ùå</div>
              <h2>Error en el Pago</h2>
              <p>Hubo un problema procesando tu pago. Por favor, intenta nuevamente.</p>
              <div className="status-actions">
                <button onClick={() => setView('membership')} className="btn btn-primary">
                  Intentar Nuevamente
                </button>
                <button onClick={() => setView('dashboard')} className="btn btn-secondary">
                  Volver al Dashboard
                </button>
              </div>
            </div>
          )}

          {paymentStatus === 'expired' && (
            <div className="status-card error">
              <div className="status-icon">‚åõ</div>
              <h2>Sesi√≥n Expirada</h2>
              <p>La sesi√≥n de pago ha expirado. Por favor, inicia el proceso nuevamente.</p>
              <div className="status-actions">
                <button onClick={() => setView('membership')} className="btn btn-primary">
                  Volver a Membres√≠as
                </button>
              </div>
            </div>
          )}

          {paymentStatus === 'timeout' && (
            <div className="status-card error">
              <div className="status-icon">‚è∞</div>
              <h2>Tiempo Agotado</h2>
              <p>No pudimos verificar el estado del pago. Revisa tu email para confirmaci√≥n o contacta soporte.</p>
              <div className="status-actions">
                <button onClick={() => setView('dashboard')} className="btn btn-secondary">
                  Ir al Dashboard
                </button>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

// Profile Page
const Profile = ({ setView }) => {
  const { veterinarian } = useVet();

  return (
    <div className="profile-page">
      <Header setView={setView} />
      
      <div className="container">
        <div className="page-header">
          <h1>Perfil Profesional</h1>
          <p>Informaci√≥n de tu cuenta veterinaria</p>
        </div>

        <div className="profile-content">
          <div className="profile-card">
            <div className="profile-header">
              <div className="profile-avatar">
                {veterinarian.nombre.charAt(0)}
              </div>
              <div className="profile-info">
                <h2>{veterinarian.nombre}</h2>
                <p>{veterinarian.especialidad}</p>
                <span className={`verification-status ${veterinarian.verified ? 'verified' : 'pending'}`}>
                  {veterinarian.verified ? '‚úÖ Verificado' : '‚è≥ Pendiente de verificaci√≥n'}
                </span>
              </div>
            </div>

            <div className="profile-details">
              <div className="detail-row">
                <strong>Email:</strong>
                <span>{veterinarian.email}</span>
              </div>
              <div className="detail-row">
                <strong>Tel√©fono:</strong>
                <span>{veterinarian.telefono}</span>
              </div>
              <div className="detail-row">
                <strong>C√©dula Profesional:</strong>
                <span>{veterinarian.cedula_profesional}</span>
              </div>
              <div className="detail-row">
                <strong>A√±os de Experiencia:</strong>
                <span>{veterinarian.a√±os_experiencia} a√±os</span>
              </div>
              <div className="detail-row">
                <strong>Instituci√≥n:</strong>
                <span>{veterinarian.institucion}</span>
              </div>
              <div className="detail-row">
                <strong>Miembro desde:</strong>
                <span>{new Date(veterinarian.created_at).toLocaleDateString()}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default App;